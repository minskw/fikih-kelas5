<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#14b8a6">
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/128/15193/15193678.png">
    <title>Media Pembelajaran Interaktif</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Poppins', sans-serif;
        }
        
        .arabic-text {
            font-family: 'Amiri', serif;
            font-size: 1.2em;
            line-height: 1.8;
            direction: rtl;
            text-align: center;
        }
        
        @media (min-width: 768px) {
            .arabic-text {
                font-size: 1.5em;
            }
        }
        
        /* Background Animations */
        .gradient-bg {
            background: linear-gradient(-45deg, #14b8a6, #0d9488, #10b981, #059669);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Card Animations */
        .card-hover {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }
        
        .card-hover::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .card-hover:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        }
        
        .card-hover:hover::before {
            left: 100%;
        }
        
        /* Progress Bar Animations */
        .progress-bar {
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-image: linear-gradient(
                -45deg,
                rgba(255, 255, 255, .2) 25%,
                transparent 25%,
                transparent 50%,
                rgba(255, 255, 255, .2) 50%,
                rgba(255, 255, 255, .2) 75%,
                transparent 75%,
                transparent
            );
            background-size: 50px 50px;
            animation: move 2s linear infinite;
        }
        
        @keyframes move {
            0% { background-position: 0 0; }
            100% { background-position: 50px 50px; }
        }
        
        /* Navigation */
        .nav-item {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .nav-item:hover {
            transform: translateY(-2px);
        }
        
        .nav-item.active {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        
        /* Page Transitions */
        .page {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Avatar Selection */
        .avatar-option {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .avatar-option:hover {
            transform: scale(1.1);
        }
        
        .avatar-option.selected {
            border: 4px solid #3b82f6;
            transform: scale(1.1);
        }
        
        /* Calculator Styles */
        .calculator-input {
            transition: all 0.3s ease;
        }
        
        .calculator-input:focus {
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }
        
        /* Payment Simulation */
        .payment-method {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .payment-method:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .payment-method.selected {
            border: 2px solid #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }
        
        /* Certificate Styles */
        .certificate {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 8px solid #ffd700;
            position: relative;
            width: 1000px !important;
            height: 707px !important;
            aspect-ratio: 1.414/1 !important;
        }
        
        .certificate::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            border: 2px solid #ffd700;
            pointer-events: none;
        }
        
        /* Certificate mobile adjustments */
        @media (max-width: 768px) {
            .certificate {
                width: 100% !important;
                height: auto !important;
                min-height: 500px;
                aspect-ratio: 1.414/1 !important;
            }
        }
        
        /* Animation for explanation */
        .animate-fadeIn {
            animation: fadeInUp 0.5s ease-out;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .card-hover:hover {
                transform: translateY(-3px) scale(1.005);
            }
            
            .nav-item {
                font-size: 0.75rem;
                padding: 0.5rem 0.75rem;
            }
            
            .nav-item i {
                font-size: 0.875rem;
            }
            
            /* Touch-friendly buttons */
            button, .quiz-option {
                min-height: 44px;
                touch-action: manipulation;
            }
            
            /* Prevent zoom on input focus */
            input, select, textarea {
                font-size: 16px;
            }
            
            /* Modal adjustments for mobile */
            .fixed.inset-0 > div {
                margin: 1rem;
                max-height: calc(100vh - 2rem);
            }
            
            /* Certificate mobile adjustments moved to main certificate section */
        }
        
        @media (max-width: 480px) {
            /* Extra small screens */
            .container {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            
            .grid {
                gap: 1rem;
            }
            
            .text-3xl {
                font-size: 1.5rem;
            }
            
            .text-2xl {
                font-size: 1.25rem;
            }
            
            .p-8 {
                padding: 1.5rem;
            }
            
            .p-6 {
                padding: 1rem;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50">
    <!-- Welcome Form -->
    <div id="welcomeForm" class="fixed inset-0 bg-gradient-to-br from-blue-600 to-purple-700 flex items-center justify-center z-50 p-2">
        <div class="bg-white rounded-2xl md:rounded-3xl p-4 md:p-6 max-w-md w-full shadow-2xl max-h-screen overflow-y-auto">
            <div class="text-center mb-4 md:mb-6">
                <div class="w-16 h-16 md:w-20 md:h-20 mx-auto mb-2 md:mb-4">
                    <img src="https://cdn-icons-png.flaticon.com/128/15044/15044863.png" alt="Logo FIKIH ITU MUDAH" class="w-full h-full object-contain">
                </div>
                <h2 class="text-xl md:text-3xl font-bold text-gray-800 mb-1 md:mb-2">Selamat Datang!</h2>
                <p class="text-sm md:text-base text-gray-600">Mari berkenalan sebelum memulai pembelajaran</p>
            </div>
            
            <form id="profileForm" class="space-y-3 md:space-y-4">
                <div>
                    <label class="block text-xs md:text-sm font-bold text-gray-700 mb-1 md:mb-2">
                        <i class="fas fa-user mr-1 md:mr-2"></i>Nama Lengkap
                    </label>
                    <input type="text" id="userName" class="w-full px-3 md:px-4 py-2 md:py-3 border-2 border-gray-300 rounded-lg md:rounded-xl focus:border-blue-500 focus:outline-none transition-all text-sm md:text-base" placeholder="Masukkan nama lengkap" required>
                </div>
                
                <div>
                    <label class="block text-xs md:text-sm font-bold text-gray-700 mb-1 md:mb-2">
                        <i class="fas fa-graduation-cap mr-1 md:mr-2"></i>Kelas
                    </label>
                    <select id="userClass" class="w-full px-3 md:px-4 py-2 md:py-3 border-2 border-gray-300 rounded-lg md:rounded-xl focus:border-blue-500 focus:outline-none transition-all text-sm md:text-base" required>
                        <option value="">Pilih Kelas</option>
                        <option value="5A">5A (Lima A)</option>
                        <option value="5B">5B (Lima B)</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-xs md:text-sm font-bold text-gray-700 mb-2 md:mb-3">
                        <i class="fas fa-camera mr-1 md:mr-2"></i>Foto Profil
                    </label>
                    
                    <!-- Photo Upload Area - Compact -->
                    <div class="text-center mb-2 md:mb-3">
                        <div id="photoPreview" class="w-20 h-20 md:w-24 md:h-24 mx-auto bg-gray-100 rounded-full border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden cursor-pointer hover:border-blue-400 transition-all" onclick="document.getElementById('photoInput').click()">
                            <div id="photoPlaceholder" class="text-center">
                                <i class="fas fa-camera text-lg md:text-2xl text-gray-400 mb-1"></i>
                                <p class="text-xs text-gray-500">Upload</p>
                            </div>
                        </div>
                        <input type="file" id="photoInput" accept="image/*" class="hidden">
                        <p class="text-xs text-gray-500 mt-1">JPG/PNG (Max 5MB)</p>
                    </div>
                    
                    <!-- Default Avatar Options - Compact -->
                    <div class="text-center">
                        <p class="text-xs md:text-sm text-gray-600 mb-2">Atau pilih avatar:</p>
                        <div class="flex justify-center gap-2 md:gap-3">
                            <div class="avatar-option w-8 h-8 md:w-10 md:h-10 bg-blue-100 rounded-full border-2 border-gray-300 cursor-pointer hover:border-blue-400 flex items-center justify-center" data-avatar="default1">
                                <i class="fas fa-user text-blue-500 text-xs md:text-sm"></i>
                            </div>
                            <div class="avatar-option w-8 h-8 md:w-10 md:h-10 bg-pink-100 rounded-full border-2 border-gray-300 cursor-pointer hover:border-pink-400 flex items-center justify-center" data-avatar="default2">
                                <i class="fas fa-user-graduate text-pink-500 text-xs md:text-sm"></i>
                            </div>
                            <div class="avatar-option w-8 h-8 md:w-10 md:h-10 bg-green-100 rounded-full border-2 border-gray-300 cursor-pointer hover:border-green-400 flex items-center justify-center" data-avatar="default3">
                                <i class="fas fa-child text-green-500 text-xs md:text-sm"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 md:py-4 rounded-lg md:rounded-xl font-bold text-sm md:text-lg hover:from-blue-600 hover:to-purple-700 transition-all hover:scale-105 mt-4 md:mt-6">
                    <i class="fas fa-rocket mr-1 md:mr-2"></i>Mulai Belajar
                </button>
            </form>
        </div>
    </div>

    <!-- Header -->
    <div class="gradient-bg text-white py-4 md:py-6 relative overflow-hidden">
        <div class="container mx-auto px-2 md:px-4">
            <!-- Logo and Title -->
            <div class="flex justify-between items-center mb-4 md:mb-0">
                <div class="flex items-center">
                    <div class="mr-2 md:mr-4">
                        <div class="w-12 h-12 md:w-16 md:h-16">
                            <img src="https://cdn-icons-png.flaticon.com/128/15193/15193678.png" alt="Logo ZAKAT FITRAH" class="w-full h-full object-contain" onerror="this.src=''; this.alt='Logo failed to load'; this.style.display='none';">
                        </div>
                    </div>
                    <div>
                        <h1 class="text-lg md:text-2xl lg:text-3xl font-bold leading-tight">KETENTUAN ZAKAT FITRAH</h1>
                        <p class="text-xs md:text-sm opacity-75">Seri Media Pembelajaran Interaktif</p>
                        <p class="text-sm md:text-lg lg:text-xl font-semibold opacity-90">FIKIH KELAS 5 MIN SINGKAWANG</p>
                    </div>
                </div>
                
                <!-- User Profile - Desktop Only -->
                <div id="userProfile" class="hidden md:flex items-center bg-white rounded-2xl px-4 py-3 shadow-lg border-2 border-white/30 min-w-0">
                    <div id="userAvatar" class="w-14 h-14 bg-gray-100 rounded-full overflow-hidden mr-4 shadow-md flex-shrink-0">
                        <svg viewBox="0 0 100 100" class="w-full h-full">
                            <circle cx="50" cy="50" r="50" fill="#e3f2fd"/>
                            <circle cx="50" cy="35" r="15" fill="#ffdbcb"/>
                            <path d="M35 45 Q50 30 65 45 Q65 60 50 65 Q35 60 35 45" fill="#ffdbcb"/>
                            <circle cx="43" cy="38" r="2" fill="#333"/>
                            <circle cx="57" cy="38" r="2" fill="#333"/>
                            <path d="M45 45 Q50 48 55 45" stroke="#333" stroke-width="1" fill="none"/>
                            <path d="M30 25 Q50 15 70 25 Q70 35 50 40 Q30 35 30 25" fill="#8b4513"/>
                        </svg>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div id="userNameDisplay" class="font-bold text-lg text-gray-800 truncate">Siswa</div>
                        <div id="userClassDisplay" class="text-sm text-gray-600 mb-2">Kelas -</div>
                        <!-- Progress Bar -->
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div id="userProgressBar" class="bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                        <div class="flex justify-between text-xs text-gray-600 mt-1">
                            <span>Progress Belajar</span>
                            <span id="userProgressText">0%</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Navigation -->
            <div class="mt-4 md:mt-6">
                <div class="flex flex-wrap gap-1 md:gap-2 lg:gap-4">
                    <div class="nav-item active px-2 md:px-4 py-2 rounded-xl text-xs md:text-sm font-medium" onclick="showPage('dashboard')">
                        <i class="fas fa-home mr-1 md:mr-2"></i><span class="hidden sm:inline">Dashboard</span><span class="sm:hidden">Home</span>
                    </div>
                    <div class="nav-item px-2 md:px-4 py-2 rounded-xl text-xs md:text-sm font-medium" onclick="showPage('pengertian')">
                        <i class="fas fa-book-open mr-1 md:mr-2"></i><span class="hidden sm:inline">Pengertian</span><span class="sm:hidden">Arti</span>
                    </div>
                    <div class="nav-item px-2 md:px-4 py-2 rounded-xl text-xs md:text-sm font-medium" onclick="showPage('ketentuan')">
                        <i class="fas fa-list-check mr-1 md:mr-2"></i><span class="hidden sm:inline">Ketentuan</span><span class="sm:hidden">Syarat</span>
                    </div>
                    <div class="nav-item px-2 md:px-4 py-2 rounded-xl text-xs md:text-sm font-medium" onclick="showPage('praktik')">
                        <i class="fas fa-hands-helping mr-1 md:mr-2"></i><span class="hidden sm:inline">Praktik</span><span class="sm:hidden">Cara</span>
                    </div>
                    <div class="nav-item px-2 md:px-4 py-2 rounded-xl text-xs md:text-sm font-medium" onclick="showPage('calculator')">
                        <i class="fas fa-calculator mr-1 md:mr-2"></i><span class="hidden sm:inline">Kalkulator</span><span class="sm:hidden">Calc</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile User Profile Card - Below Header -->
    <div class="md:hidden bg-white shadow-lg mx-2 mt-2 rounded-2xl p-4 border-2 border-gray-100">
        <div class="flex items-center">
            <div id="userAvatarMobile" class="w-16 h-16 bg-gray-100 rounded-full overflow-hidden mr-4 shadow-md flex-shrink-0">
                <svg viewBox="0 0 100 100" class="w-full h-full">
                    <circle cx="50" cy="50" r="50" fill="#e3f2fd"/>
                    <circle cx="50" cy="35" r="15" fill="#ffdbcb"/>
                    <path d="M35 45 Q50 30 65 45 Q65 60 50 65 Q35 60 35 45" fill="#ffdbcb"/>
                    <circle cx="43" cy="38" r="2" fill="#333"/>
                    <circle cx="57" cy="38" r="2" fill="#333"/>
                    <path d="M45 45 Q50 48 55 45" stroke="#333" stroke-width="1" fill="none"/>
                    <path d="M30 25 Q50 15 70 25 Q70 35 50 40 Q30 35 30 25" fill="#8b4513"/>
                </svg>
            </div>
            <div class="flex-1 min-w-0">
                <div id="userNameDisplayMobile" class="font-bold text-lg text-gray-800 truncate mb-1">Siswa</div>
                <div id="userClassDisplayMobile" class="text-sm text-gray-600 mb-3">Kelas -</div>
                <!-- Progress Bar -->
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div id="userProgressBarMobile" class="bg-gradient-to-r from-blue-500 to-purple-600 h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
                </div>
                <div class="flex justify-between text-xs text-gray-600 mt-2">
                    <span>Progress Belajar</span>
                    <span id="userProgressTextMobile">0%</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container mx-auto px-2 md:px-4 py-4 md:py-8 max-w-7xl">
        <!-- Dashboard Page -->
        <div id="dashboard" class="page active">
            <!-- Progress Overview -->
            <div class="bg-white rounded-2xl md:rounded-3xl shadow-xl p-4 md:p-8 mb-4 md:mb-8 card-hover">
                <div class="flex items-center mb-4 md:mb-6">
                    <i class="fas fa-chart-line text-2xl md:text-3xl text-blue-500 mr-2 md:mr-4"></i>
                    <h2 class="text-xl md:text-3xl font-bold text-gray-800">Ringkasan Pembelajaran Zakat Fitrah</h2>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-6">
                    <div class="text-center p-3 md:p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl card-hover">
                        <div class="text-3xl md:text-5xl mb-2 md:mb-4">
                            <i class="fas fa-book-open text-blue-500"></i>
                        </div>
                        <div class="font-bold text-gray-800 text-sm md:text-lg mb-1 md:mb-2">Pengertian</div>
                        <div class="text-xs md:text-sm text-gray-600 mb-2 md:mb-3">Progress: <span class="font-bold" id="pengertianProgress">0%</span></div>
                        <div class="w-full bg-gray-200 rounded-full h-2 md:h-3">
                            <div class="bg-gradient-to-r from-blue-400 to-blue-600 h-2 md:h-3 rounded-full progress-bar" id="pengertianProgressBar" style="width: 0%"></div>
                        </div>
                        <button class="mt-2 md:mt-4 px-3 md:px-4 py-2 bg-blue-500 text-white rounded-lg text-xs md:text-sm hover:bg-blue-600 transition-all" onclick="showPage('pengertian')">
                            <i class="fas fa-play mr-1"></i>Mulai
                        </button>
                    </div>
                    
                    <div class="text-center p-3 md:p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-2xl card-hover">
                        <div class="text-3xl md:text-5xl mb-2 md:mb-4">
                            <i class="fas fa-list-check text-green-500"></i>
                        </div>
                        <div class="font-bold text-gray-800 text-sm md:text-lg mb-1 md:mb-2">Ketentuan</div>
                        <div class="text-xs md:text-sm text-gray-600 mb-2 md:mb-3">Progress: <span class="font-bold" id="ketentuanProgress">0%</span></div>
                        <div class="w-full bg-gray-200 rounded-full h-2 md:h-3">
                            <div class="bg-gradient-to-r from-green-400 to-green-600 h-2 md:h-3 rounded-full progress-bar" id="ketentuanProgressBar" style="width: 0%"></div>
                        </div>
                        <button class="mt-2 md:mt-4 px-3 md:px-4 py-2 bg-green-500 text-white rounded-lg text-xs md:text-sm hover:bg-green-600 transition-all" onclick="showPage('ketentuan')">
                            <i class="fas fa-play mr-1"></i>Mulai
                        </button>
                    </div>
                    
                    <div class="text-center p-3 md:p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-2xl card-hover">
                        <div class="text-3xl md:text-5xl mb-2 md:mb-4">
                            <i class="fas fa-hands-helping text-purple-500"></i>
                        </div>
                        <div class="font-bold text-gray-800 text-sm md:text-lg mb-1 md:mb-2">Praktik</div>
                        <div class="text-xs md:text-sm text-gray-600 mb-2 md:mb-3">Progress: <span class="font-bold" id="praktikProgress">0%</span></div>
                        <div class="w-full bg-gray-200 rounded-full h-2 md:h-3">
                            <div class="bg-gradient-to-r from-purple-400 to-purple-600 h-2 md:h-3 rounded-full progress-bar" id="praktikProgressBar" style="width: 0%"></div>
                        </div>
                        <button class="mt-2 md:mt-4 px-3 md:px-4 py-2 bg-purple-500 text-white rounded-lg text-xs md:text-sm hover:bg-purple-600 transition-all" onclick="showPage('praktik')">
                            <i class="fas fa-play mr-1"></i>Mulai
                        </button>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-6">
                <div class="bg-white rounded-2xl shadow-lg p-4 md:p-6 card-hover">
                    <div class="flex items-center">
                        <div class="bg-blue-100 p-2 md:p-3 rounded-full mr-3 md:mr-4">
                            <i class="fas fa-trophy text-blue-600 text-lg md:text-xl"></i>
                        </div>
                        <div>
                            <div class="text-xl md:text-2xl font-bold text-gray-800" id="totalBadges">0</div>
                            <div class="text-xs md:text-sm text-gray-600">Badge Diraih</div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-lg p-4 md:p-6 card-hover">
                    <div class="flex items-center">
                        <div class="bg-green-100 p-2 md:p-3 rounded-full mr-3 md:mr-4">
                            <i class="fas fa-check-circle text-green-600 text-lg md:text-xl"></i>
                        </div>
                        <div>
                            <div class="text-xl md:text-2xl font-bold text-gray-800" id="completedModules">0/6</div>
                            <div class="text-xs md:text-sm text-gray-600">Modul Selesai</div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-lg p-4 md:p-6 card-hover">
                    <div class="flex items-center">
                        <div class="bg-purple-100 p-2 md:p-3 rounded-full mr-3 md:mr-4">
                            <i class="fas fa-clock text-purple-600 text-lg md:text-xl"></i>
                        </div>
                        <div>
                            <div class="text-xl md:text-2xl font-bold text-gray-800" id="studyTime">0 menit</div>
                            <div class="text-xs md:text-sm text-gray-600">Waktu Belajar</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pengertian Page -->
        <div id="pengertian" class="page">
            <div class="bg-white rounded-2xl md:rounded-3xl shadow-xl p-4 md:p-8 mb-4 md:mb-8">
                <div class="flex items-center mb-4 md:mb-6">
                    <i class="fas fa-book-open text-2xl md:text-3xl text-blue-500 mr-2 md:mr-4"></i>
                    <h2 class="text-xl md:text-3xl font-bold text-gray-800">Pengertian Zakat Fitrah</h2>
                </div>
                
                <!-- Learning Progress Overview -->
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-4 md:p-6 rounded-2xl mb-6 md:mb-8">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg md:text-xl font-bold text-blue-800">
                            <i class="fas fa-chart-line mr-2"></i>Progress Pembelajaran
                        </h3>
                        <div class="text-right">
                            <div class="text-2xl md:text-3xl font-bold text-blue-600" id="pengertianOverallScore">0%</div>
                            <div class="text-xs md:text-sm text-blue-700">Nilai Akhir</div>
                        </div>
                    </div>
                    <div class="w-full bg-white rounded-full h-3 md:h-4">
                        <div class="bg-gradient-to-r from-blue-500 to-blue-600 h-3 md:h-4 rounded-full transition-all duration-500" id="pengertianOverallProgress" style="width: 0%"></div>
                    </div>
                    <p class="text-xs md:text-sm text-blue-600 mt-2">
                        <i class="fas fa-info-circle mr-1"></i>
                        Selesaikan semua sub-materi untuk melanjutkan ke bagian selanjutnya
                    </p>
                </div>
                
                <!-- Learning Modules -->
                <div class="mb-6 md:mb-8">
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-4 md:mb-6">
                        <i class="fas fa-book-open mr-2"></i>Sub-Materi Pembelajaran
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6" id="pengertianModules">
                        <!-- Modules will be dynamically generated -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Ketentuan Page -->
        <div id="ketentuan" class="page">
            <div class="bg-white rounded-2xl md:rounded-3xl shadow-xl p-4 md:p-8 mb-4 md:mb-8">
                <div class="flex items-center mb-4 md:mb-6">
                    <i class="fas fa-list-check text-2xl md:text-3xl text-green-500 mr-2 md:mr-4"></i>
                    <h2 class="text-xl md:text-3xl font-bold text-gray-800">Ketentuan Zakat Fitrah</h2>
                </div>
                
                <!-- Learning Progress Overview -->
                <div class="bg-gradient-to-br from-green-50 to-green-100 p-4 md:p-6 rounded-2xl mb-6 md:mb-8">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg md:text-xl font-bold text-green-800">
                            <i class="fas fa-chart-line mr-2"></i>Progress Pembelajaran
                        </h3>
                        <div class="text-right">
                            <div class="text-2xl md:text-3xl font-bold text-green-600" id="ketentuanOverallScore">0%</div>
                            <div class="text-xs md:text-sm text-green-700">Nilai Akhir</div>
                        </div>
                    </div>
                    <div class="w-full bg-white rounded-full h-3 md:h-4">
                        <div class="bg-gradient-to-r from-green-500 to-green-600 h-3 md:h-4 rounded-full transition-all duration-500" id="ketentuanOverallProgress" style="width: 0%"></div>
                    </div>
                    <p class="text-xs md:text-sm text-green-600 mt-2">
                        <i class="fas fa-info-circle mr-1"></i>
                        Selesaikan semua sub-materi untuk melanjutkan ke bagian selanjutnya
                    </p>
                </div>
                
                <!-- Learning Modules -->
                <div class="mb-6 md:mb-8">
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-4 md:mb-6">
                        <i class="fas fa-book-open mr-2"></i>Sub-Materi Pembelajaran
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6" id="ketentuanModules">
                        <!-- Modules will be dynamically generated -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Praktik Page -->
        <div id="praktik" class="page">
            <div class="bg-white rounded-2xl md:rounded-3xl shadow-xl p-4 md:p-8 mb-4 md:mb-8">
                <div class="flex items-center mb-4 md:mb-6">
                    <i class="fas fa-hands-helping text-2xl md:text-3xl text-purple-500 mr-2 md:mr-4"></i>
                    <h2 class="text-xl md:text-3xl font-bold text-gray-800">Praktik Zakat Fitrah</h2>
                </div>
                
                <!-- Learning Progress Overview -->
                <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-4 md:p-6 rounded-2xl mb-6 md:mb-8">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg md:text-xl font-bold text-purple-800">
                            <i class="fas fa-chart-line mr-2"></i>Progress Pembelajaran
                        </h3>
                        <div class="text-right">
                            <div class="text-2xl md:text-3xl font-bold text-purple-600" id="praktikOverallScore">0%</div>
                            <div class="text-xs md:text-sm text-purple-700">Nilai Akhir</div>
                        </div>
                    </div>
                    <div class="w-full bg-white rounded-full h-3 md:h-4">
                        <div class="bg-gradient-to-r from-purple-500 to-purple-600 h-3 md:h-4 rounded-full transition-all duration-500" id="praktikOverallProgress" style="width: 0%"></div>
                    </div>
                    <p class="text-xs md:text-sm text-purple-600 mt-2">
                        <i class="fas fa-info-circle mr-1"></i>
                        Selesaikan semua sub-materi untuk menyelesaikan pembelajaran
                    </p>
                </div>
                
                <!-- Learning Modules -->
                <div class="mb-6 md:mb-8">
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-4 md:mb-6">
                        <i class="fas fa-book-open mr-2"></i>Sub-Materi Pembelajaran
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6" id="praktikModules">
                        <!-- Modules will be dynamically generated -->
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="border-t pt-6 md:pt-8">
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-4 md:mb-6">
                        <i class="fas fa-tools mr-2"></i>Alat Bantu Pembelajaran
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4">
                        <button class="flex items-center justify-center px-4 md:px-6 py-3 md:py-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all hover:scale-105" onclick="showPage('calculator')">
                            <i class="fas fa-calculator mr-2 md:mr-3 text-lg md:text-xl"></i>
                            <div class="text-left">
                                <div class="font-bold text-sm md:text-base">Kalkulator Zakat</div>
                                <div class="text-xs md:text-sm opacity-90">Hitung jumlah zakat fitrah</div>
                            </div>
                        </button>
                        
                        <button class="flex items-center justify-center px-4 md:px-6 py-3 md:py-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl hover:from-green-600 hover:to-green-700 transition-all hover:scale-105" onclick="showPaymentSimulation()">
                            <i class="fas fa-credit-card mr-2 md:mr-3 text-lg md:text-xl"></i>
                            <div class="text-left">
                                <div class="font-bold text-sm md:text-base">Simulasi Pembayaran</div>
                                <div class="text-xs md:text-sm opacity-90">Praktik bayar zakat fitrah</div>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Calculator Page -->
        <div id="calculator" class="page">
            <div class="bg-white rounded-2xl md:rounded-3xl shadow-xl p-4 md:p-8">
                <div class="flex items-center mb-4 md:mb-6">
                    <i class="fas fa-calculator text-2xl md:text-3xl text-green-500 mr-2 md:mr-4"></i>
                    <h2 class="text-xl md:text-3xl font-bold text-gray-800">Kalkulator Zakat Fitrah</h2>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-8">
                    <!-- Input Form -->
                    <div class="space-y-4 md:space-y-6">
                        <div class="bg-gradient-to-br from-green-50 to-green-100 p-4 md:p-6 rounded-2xl">
                            <h3 class="text-lg md:text-xl font-bold text-green-800 mb-3 md:mb-4">
                                <i class="fas fa-users mr-2"></i>Data Keluarga
                            </h3>
                            
                            <div class="space-y-3 md:space-y-4">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Jumlah Anggota Keluarga</label>
                                    <input type="number" id="familyMembers" class="calculator-input w-full px-3 md:px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-green-500 focus:outline-none text-base" placeholder="Masukkan jumlah anggota" min="1" value="4">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Harga Beras per Kg</label>
                                    <input type="number" id="ricePrice" class="calculator-input w-full px-3 md:px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-green-500 focus:outline-none text-base" placeholder="Harga beras (Rp)" value="15000">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Jenis Pembayaran</label>
                                    <select id="paymentType" class="calculator-input w-full px-3 md:px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-green-500 focus:outline-none text-base">
                                        <option value="beras">Beras (2.5 kg/orang)</option>
                                        <option value="uang">Uang (setara harga beras)</option>
                                        <option value="campuran">Campuran</option>
                                    </select>
                                </div>
                                
                                <button onclick="calculateZakat()" class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-3 md:py-4 rounded-xl font-bold text-base md:text-lg hover:from-green-600 hover:to-green-700 transition-all hover:scale-105">
                                    <i class="fas fa-calculator mr-2"></i>Hitung Zakat
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Result -->
                    <div class="space-y-6">
                        <div id="calculatorResult" class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-2xl">
                            <h3 class="text-xl font-bold text-blue-800 mb-4">
                                <i class="fas fa-chart-pie mr-2"></i>Hasil Perhitungan
                            </h3>
                            <div class="text-center py-8">
                                <i class="fas fa-calculator text-6xl text-blue-300 mb-4"></i>
                                <p class="text-blue-600">Masukkan data untuk melihat hasil perhitungan</p>
                            </div>
                        </div>
                        
                        <!-- Quick Reference -->
                        <div class="bg-gradient-to-br from-yellow-50 to-yellow-100 p-6 rounded-2xl">
                            <h3 class="text-lg font-bold text-yellow-800 mb-4">
                                <i class="fas fa-info-circle mr-2"></i>Panduan Cepat
                            </h3>
                            <div class="space-y-3 text-sm">
                                <div class="flex items-center">
                                    <i class="fas fa-check text-yellow-600 mr-2"></i>
                                    <span>1 orang = 2.5 kg beras</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-check text-yellow-600 mr-2"></i>
                                    <span>Keluarga 4 orang = 10 kg beras</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-check text-yellow-600 mr-2"></i>
                                    <span>Boleh diganti dengan uang setara</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-check text-yellow-600 mr-2"></i>
                                    <span>Dibayar sebelum shalat Id</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Learning Modal -->
    <div id="learningModal" class="fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center hidden z-50 p-2 md:p-4">
        <div class="bg-white rounded-2xl md:rounded-3xl max-w-4xl w-full max-h-[95vh] md:max-h-[90vh] overflow-hidden flex flex-col">
            <div class="gradient-bg text-white p-4 md:p-6 flex-shrink-0">
                <div class="flex justify-between items-center">
                    <h3 id="modalTitle" class="text-lg md:text-2xl font-bold">Materi Pembelajaran</h3>
                    <button class="text-white hover:text-gray-200 text-xl md:text-2xl" onclick="closeLearningModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div id="modalContent" class="p-4 md:p-6 overflow-y-auto flex-1">
                <!-- Content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Payment Simulation Modal -->
    <div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center hidden z-50 p-2 md:p-4">
        <div class="bg-white rounded-2xl md:rounded-3xl max-w-2xl w-full max-h-[95vh] md:max-h-[90vh] overflow-hidden flex flex-col">
            <div class="bg-gradient-to-r from-green-500 to-green-600 text-white p-4 md:p-6 rounded-t-2xl md:rounded-t-3xl flex-shrink-0">
                <div class="flex justify-between items-center">
                    <h3 class="text-lg md:text-2xl font-bold">
                        <i class="fas fa-credit-card mr-2"></i>Simulasi Pembayaran Zakat
                    </h3>
                    <button class="text-white hover:text-gray-200 text-xl md:text-2xl" onclick="closePaymentModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div id="paymentContent" class="p-4 md:p-6 overflow-y-auto flex-1">
                <!-- Payment content will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let userProfile = {
            name: '',
            class: '',
            avatar: 'default1',
            avatarSvg: `<div class="w-full h-full bg-blue-100 flex items-center justify-center"><i class="fas fa-user text-blue-500 text-2xl"></i></div>`,
            photoData: null
        };
        
        let learningProgress = {
            pengertian: 0,
            ketentuan: 0,
            praktik: 0
        };
        
        let materialProgress = {
            pengertian: {
                definisi: 0,
                dalil: 0
            },
            ketentuan: {
                syarat_wajib: 0,
                takaran_waktu: 0
            },
            praktik: {
                cara_hitung: 0,
                cara_salur: 0
            }
        };
        
        let quizResults = {
            pengertian: [],
            ketentuan: [],
            praktik: []
        };
        
        let studyStartTime = null;
        let totalStudyTime = 0;
        let badges = [];
        let calculatorHistory = [];

        // Initialize app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // Setup form submission
            const profileForm = document.getElementById('profileForm');
            if (profileForm) {
                profileForm.addEventListener('submit', handleProfileSubmit);
            }

            // Setup avatar selection
            setupAvatarSelection();
            
            // Setup photo upload
            setupPhotoUpload();
        }

        function handleProfileSubmit(e) {
            e.preventDefault();
            
            const name = document.getElementById('userName').value.trim();
            const userClass = document.getElementById('userClass').value;
            
            if (!name || !userClass) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Data Belum Lengkap',
                    text: 'Mohon lengkapi nama dan kelas terlebih dahulu!',
                    confirmButtonColor: '#3b82f6'
                });
                return;
            }
            
            // Save user profile
            userProfile.name = name;
            userProfile.class = userClass;
            
            // Update UI with user data
            updateUserProfile();
            
            // Hide welcome form and show main app
            document.getElementById('welcomeForm').style.display = 'none';
            
            // Start study timer
            studyStartTime = Date.now();
            
            // Show welcome message
            Swal.fire({
                icon: 'success',
                title: `Selamat Datang, ${name}!`,
                text: `Mari mulai belajar Zakat Fitrah bersama-sama!`,
                confirmButtonColor: '#10b981',
                timer: 3000,
                timerProgressBar: true
            });
            
            // Initialize learning modules
            initializeLearningModules();
        }

        function setupAvatarSelection() {
            const avatarOptions = document.querySelectorAll('.avatar-option');
            avatarOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove selected class from all options
                    avatarOptions.forEach(opt => opt.classList.remove('selected'));
                    
                    // Add selected class to clicked option
                    this.classList.add('selected');
                    
                    // Update user profile avatar
                    userProfile.avatar = this.dataset.avatar;
                    
                    // Clear photo preview if avatar is selected
                    const photoPreview = document.getElementById('photoPreview');
                    const photoPlaceholder = document.getElementById('photoPlaceholder');
                    photoPreview.innerHTML = '';
                    photoPreview.appendChild(photoPlaceholder);
                    userProfile.photoData = null;
                });
            });
        }

        function setupPhotoUpload() {
            const photoInput = document.getElementById('photoInput');
            const photoPreview = document.getElementById('photoPreview');
            
            if (photoInput) {
                photoInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        // Check file size (max 5MB)
                        if (file.size > 5 * 1024 * 1024) {
                            Swal.fire({
                                icon: 'error',
                                title: 'File Terlalu Besar',
                                text: 'Ukuran file maksimal 5MB',
                                confirmButtonColor: '#ef4444'
                            });
                            return;
                        }
                        
                        // Check file type
                        if (!file.type.startsWith('image/')) {
                            Swal.fire({
                                icon: 'error',
                                title: 'Format File Salah',
                                text: 'Hanya file gambar (JPG/PNG) yang diperbolehkan',
                                confirmButtonColor: '#ef4444'
                            });
                            return;
                        }
                        
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            userProfile.photoData = e.target.result;
                            
                            // Update preview
                            photoPreview.innerHTML = `<img src="${e.target.result}" alt="Profile Photo" class="w-full h-full object-cover rounded-full">`;
                            
                            // Clear avatar selection
                            document.querySelectorAll('.avatar-option').forEach(opt => opt.classList.remove('selected'));
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        }

        function updateUserProfile() {
            // Update desktop profile
            const userNameDisplay = document.getElementById('userNameDisplay');
            const userClassDisplay = document.getElementById('userClassDisplay');
            const userAvatar = document.getElementById('userAvatar');
            
            if (userNameDisplay) userNameDisplay.textContent = userProfile.name;
            if (userClassDisplay) userClassDisplay.textContent = `Kelas ${userProfile.class}`;
            
            // Update mobile profile
            const userNameDisplayMobile = document.getElementById('userNameDisplayMobile');
            const userClassDisplayMobile = document.getElementById('userClassDisplayMobile');
            const userAvatarMobile = document.getElementById('userAvatarMobile');
            
            if (userNameDisplayMobile) userNameDisplayMobile.textContent = userProfile.name;
            if (userClassDisplayMobile) userClassDisplayMobile.textContent = `Kelas ${userProfile.class}`;
            
            // Update avatar
            if (userProfile.photoData) {
                if (userAvatar) userAvatar.innerHTML = `<img src="${userProfile.photoData}" alt="Profile Photo" class="w-full h-full object-cover rounded-full">`;
                if (userAvatarMobile) userAvatarMobile.innerHTML = `<img src="${userProfile.photoData}" alt="Profile Photo" class="w-full h-full object-cover rounded-full">`;
            } else {
                // Use default avatar based on selection
                const avatarHtml = getAvatarHtml(userProfile.avatar);
                if (userAvatar) userAvatar.innerHTML = avatarHtml;
                if (userAvatarMobile) userAvatarMobile.innerHTML = avatarHtml;
            }
        }

        function getAvatarHtml(avatarType) {
            switch(avatarType) {
                case 'default1':
                    return `<div class="w-full h-full bg-blue-100 flex items-center justify-center rounded-full"><i class="fas fa-user text-blue-500 text-2xl"></i></div>`;
                case 'default2':
                    return `<div class="w-full h-full bg-pink-100 flex items-center justify-center rounded-full"><i class="fas fa-user-graduate text-pink-500 text-2xl"></i></div>`;
                case 'default3':
                    return `<div class="w-full h-full bg-green-100 flex items-center justify-center rounded-full"><i class="fas fa-child text-green-500 text-2xl"></i></div>`;
                default:
                    return `<div class="w-full h-full bg-blue-100 flex items-center justify-center rounded-full"><i class="fas fa-user text-blue-500 text-2xl"></i></div>`;
            }
        }

        function initializeLearningModules() {
            // Initialize modules for each section
            generateModules('pengertian');
            generateModules('ketentuan');
            generateModules('praktik');
            
            // Update progress displays
            updateProgressDisplays();
        }

        function generateModules(section) {
            const container = document.getElementById(`${section}Modules`);
            if (!container) return;
            
            const materials = learningContent[section].materials;
            
            container.innerHTML = materials.map((material, index) => {
                const isLocked = !material.unlocked && materialProgress[section][material.id] < (material.requiredScore || 0);
                const progress = materialProgress[section][material.id] || 0;
                
                return `
                    <div class="bg-white rounded-2xl shadow-lg p-4 md:p-6 card-hover ${isLocked ? 'opacity-60' : ''}">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mr-4">
                                    <i class="fas ${isLocked ? 'fa-lock' : 'fa-book'} text-white text-lg"></i>
                                </div>
                                <div>
                                    <h4 class="font-bold text-gray-800 text-sm md:text-base">${material.title}</h4>
                                    <p class="text-xs md:text-sm text-gray-600">Progress: ${progress}%</p>
                                </div>
                            </div>
                            ${!isLocked ? `
                                <button class="px-3 md:px-4 py-2 bg-blue-500 text-white rounded-lg text-xs md:text-sm hover:bg-blue-600 transition-all" onclick="openLearningMaterial('${section}', '${material.id}')">
                                    <i class="fas fa-play mr-1"></i>Belajar
                                </button>
                            ` : `
                                <div class="text-xs text-gray-500">
                                    ${material.requiredMaterial ? `Selesaikan "${learningContent[section].materials.find(m => m.id === material.requiredMaterial)?.title}" terlebih dahulu` : 'Terkunci'}
                                </div>
                            `}
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full transition-all duration-500" style="width: ${progress}%"></div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function openLearningMaterial(section, materialId) {
            const material = learningContent[section].materials.find(m => m.id === materialId);
            if (!material) return;
            
            document.getElementById('modalTitle').textContent = material.title;
            document.getElementById('modalContent').innerHTML = `
                ${material.content}
                <div class="mt-8 pt-6 border-t">
                    <button class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-3 rounded-xl font-bold hover:from-green-600 hover:to-green-700 transition-all" onclick="startQuiz('${section}', '${materialId}')">
                        <i class="fas fa-question-circle mr-2"></i>Lanjut ke Kuis
                    </button>
                </div>
            `;
            
            document.getElementById('learningModal').classList.remove('hidden');
            
            // Mark as read (50% progress)
            if (materialProgress[section][materialId] < 50) {
                materialProgress[section][materialId] = 50;
                updateProgressDisplays();
            }
        }

        function startQuiz(section, materialId) {
            const quiz = learningContent[section].quiz;
            if (!quiz || quiz.length === 0) return;
            
            let currentQuestion = 0;
            let score = 0;
            let answers = [];
            
            function showQuestion() {
                const question = quiz[currentQuestion];
                document.getElementById('modalContent').innerHTML = `
                    <div class="text-center mb-6">
                        <div class="text-sm text-gray-600 mb-2">Pertanyaan ${currentQuestion + 1} dari ${quiz.length}</div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full transition-all" style="width: ${((currentQuestion) / quiz.length) * 100}%"></div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-2xl mb-6">
                        <h4 class="text-lg font-bold text-blue-800 mb-4">${question.question}</h4>
                        <div class="space-y-3">
                            ${question.options.map((option, index) => `
                                <button class="quiz-option w-full text-left p-4 bg-white rounded-xl border-2 border-gray-200 hover:border-blue-400 hover:bg-blue-50 transition-all" onclick="selectAnswer(${index})">
                                    <span class="font-medium">${String.fromCharCode(65 + index)}.</span> ${option}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            window.selectAnswer = function(selectedIndex) {
                const question = quiz[currentQuestion];
                const isCorrect = selectedIndex === question.correct;
                
                if (isCorrect) score++;
                answers.push({
                    question: currentQuestion,
                    selected: selectedIndex,
                    correct: question.correct,
                    isCorrect: isCorrect
                });
                
                // Show explanation
                document.getElementById('modalContent').innerHTML = `
                    <div class="text-center mb-6">
                        <div class="text-sm text-gray-600 mb-2">Pertanyaan ${currentQuestion + 1} dari ${quiz.length}</div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full transition-all" style="width: ${((currentQuestion + 1) / quiz.length) * 100}%"></div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br ${isCorrect ? 'from-green-50 to-green-100' : 'from-red-50 to-red-100'} p-6 rounded-2xl mb-6">
                        <div class="text-center mb-4">
                            <i class="fas ${isCorrect ? 'fa-check-circle text-green-500' : 'fa-times-circle text-red-500'} text-4xl mb-2"></i>
                            <h4 class="text-lg font-bold ${isCorrect ? 'text-green-800' : 'text-red-800'}">${isCorrect ? 'Benar!' : 'Salah!'}</h4>
                        </div>
                        <p class="text-gray-700 text-center">${question.explanation}</p>
                    </div>
                    
                    <button class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 rounded-xl font-bold hover:from-blue-600 hover:to-blue-700 transition-all" onclick="nextQuestion()">
                        ${currentQuestion < quiz.length - 1 ? 'Pertanyaan Selanjutnya' : 'Lihat Hasil'}
                    </button>
                `;
                
                window.nextQuestion = function() {
                    currentQuestion++;
                    if (currentQuestion < quiz.length) {
                        showQuestion();
                    } else {
                        showResults();
                    }
                };
            };
            
            function showResults() {
                const percentage = Math.round((score / quiz.length) * 100);
                const passed = percentage >= 70;
                
                // Update progress
                materialProgress[section][materialId] = percentage;
                quizResults[section].push({
                    materialId: materialId,
                    score: percentage,
                    answers: answers,
                    timestamp: new Date()
                });
                
                // Check if material should be unlocked
                if (passed) {
                    const nextMaterial = learningContent[section].materials.find(m => m.requiredMaterial === materialId);
                    if (nextMaterial) {
                        nextMaterial.unlocked = true;
                    }
                }
                
                document.getElementById('modalContent').innerHTML = `
                    <div class="text-center">
                        <div class="text-6xl mb-4">
                            ${passed ? '🎉' : '😔'}
                        </div>
                        <h3 class="text-2xl font-bold ${passed ? 'text-green-600' : 'text-red-600'} mb-2">
                            ${passed ? 'Selamat!' : 'Belum Berhasil'}
                        </h3>
                        <p class="text-gray-600 mb-6">
                            Nilai Anda: <span class="font-bold text-2xl ${passed ? 'text-green-600' : 'text-red-600'}">${percentage}%</span>
                        </p>
                        
                        <div class="bg-gray-50 p-4 rounded-xl mb-6">
                            <div class="text-sm text-gray-600 mb-2">Detail Hasil:</div>
                            <div class="text-sm">Benar: ${score} dari ${quiz.length} soal</div>
                            <div class="text-sm">Nilai minimum untuk lulus: 70%</div>
                        </div>
                        
                        <div class="space-y-3">
                            ${passed ? `
                                <button class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-3 rounded-xl font-bold hover:from-green-600 hover:to-green-700 transition-all" onclick="closeLearningModal()">
                                    <i class="fas fa-check mr-2"></i>Selesai
                                </button>
                            ` : `
                                <button class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 rounded-xl font-bold hover:from-blue-600 hover:to-blue-700 transition-all" onclick="startQuiz('${section}', '${materialId}')">
                                    <i class="fas fa-redo mr-2"></i>Coba Lagi
                                </button>
                                <button class="w-full bg-gray-500 text-white py-3 rounded-xl font-bold hover:bg-gray-600 transition-all" onclick="closeLearningModal()">
                                    <i class="fas fa-times mr-2"></i>Tutup
                                </button>
                            `}
                        </div>
                    </div>
                `;
                
                updateProgressDisplays();
                generateModules(section);
            }
            
            showQuestion();
        }

        function updateProgressDisplays() {
            // Calculate overall progress for each section
            const sections = ['pengertian', 'ketentuan', 'praktik'];
            
            sections.forEach(section => {
                const materials = learningContent[section].materials;
                const totalProgress = materials.reduce((sum, material) => {
                    return sum + (materialProgress[section][material.id] || 0);
                }, 0);
                const averageProgress = Math.round(totalProgress / materials.length);
                
                learningProgress[section] = averageProgress;
                
                // Update progress bars and text
                const progressBar = document.getElementById(`${section}ProgressBar`);
                const progressText = document.getElementById(`${section}Progress`);
                const overallProgressBar = document.getElementById(`${section}OverallProgress`);
                const overallScore = document.getElementById(`${section}OverallScore`);
                
                if (progressBar) progressBar.style.width = `${averageProgress}%`;
                if (progressText) progressText.textContent = `${averageProgress}%`;
                if (overallProgressBar) overallProgressBar.style.width = `${averageProgress}%`;
                if (overallScore) overallScore.textContent = `${averageProgress}%`;
            });
            
            // Update overall user progress
            const totalProgress = sections.reduce((sum, section) => sum + learningProgress[section], 0);
            const overallProgress = Math.round(totalProgress / sections.length);
            
            const userProgressBar = document.getElementById('userProgressBar');
            const userProgressText = document.getElementById('userProgressText');
            const userProgressBarMobile = document.getElementById('userProgressBarMobile');
            const userProgressTextMobile = document.getElementById('userProgressTextMobile');
            
            if (userProgressBar) userProgressBar.style.width = `${overallProgress}%`;
            if (userProgressText) userProgressText.textContent = `${overallProgress}%`;
            if (userProgressBarMobile) userProgressBarMobile.style.width = `${overallProgress}%`;
            if (userProgressTextMobile) userProgressTextMobile.textContent = `${overallProgress}%`;
            
            // Update completed modules count
            const completedModules = Object.values(materialProgress).reduce((count, section) => {
                return count + Object.values(section).filter(progress => progress >= 70).length;
            }, 0);
            
            const completedModulesElement = document.getElementById('completedModules');
            if (completedModulesElement) {
                completedModulesElement.textContent = `${completedModules}/6`;
            }
            
            // Update study time
            if (studyStartTime) {
                const currentTime = Date.now();
                const studyDuration = Math.round((currentTime - studyStartTime) / 60000); // in minutes
                const studyTimeElement = document.getElementById('studyTime');
                if (studyTimeElement) {
                    studyTimeElement.textContent = `${studyDuration} menit`;
                }
            }
        }

        // Complete Learning Content Data for Zakat Fitrah
        const learningContent = {
            pengertian: {
                title: 'Pengertian Zakat Fitrah',
                materials: [
                    {
                        id: 'definisi',
                        title: 'Definisi Zakat Fitrah',
                        unlocked: true,
                        content: `
                            <div class="space-y-6">
                                <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-2xl">
                                    <h4 class="text-xl font-bold text-blue-800 mb-4">
                                        <i class="fas fa-search mr-2"></i>Apa itu Zakat Fitrah?
                                    </h4>
                                    <p class="text-gray-700 leading-relaxed mb-4">
                                        Zakat fitrah adalah zakat yang wajib dikeluarkan oleh setiap Muslim yang mampu pada bulan Ramadan. 
                                        Kata "fitrah" berasal dari bahasa Arab yang berarti "sifat dasar" atau "kesucian".
                                    </p>
                                    <div class="bg-white p-4 rounded-xl border-l-4 border-blue-500">
                                        <p class="text-blue-800 font-medium">
                                            <i class="fas fa-lightbulb mr-2"></i>
                                            Zakat fitrah bertujuan untuk mensucikan jiwa dari sifat kikir dan membantu fakir miskin.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    {
                        id: 'dalil',
                        title: 'Dalil Al-Quran dan Hadits',
                        unlocked: false,
                        requiredScore: 70,
                        requiredMaterial: 'definisi',
                        content: `
                            <div class="space-y-6">
                                <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-2xl">
                                    <h4 class="text-xl font-bold text-green-800 mb-4">
                                        <i class="fas fa-book-open mr-2"></i>Dalil Al-Quran dan Hadits
                                    </h4>
                                    <div class="bg-white p-4 rounded-xl mb-4">
                                        <p class="arabic-text text-green-800 font-bold mb-2">قَدْ أَفْلَحَ مَنْ تَزَكَّى</p>
                                        <p class="text-center italic text-gray-700">"Sungguh beruntung orang yang membersihkan diri (dengan zakat)"</p>
                                        <p class="text-center text-sm text-gray-500">(QS. Al-A'la: 14)</p>
                                    </div>
                                    <div class="bg-white p-4 rounded-xl">
                                        <p class="arabic-text text-green-800 font-bold mb-2">فَرَضَ رَسُولُ اللَّهِ صلى الله عليه وسلم زَكَاةَ الْفِطْرِ</p>
                                        <p class="text-center italic text-gray-700">"Rasulullah SAW mewajibkan zakat fitrah"</p>
                                        <p class="text-center text-sm text-gray-500">(HR. Bukhari Muslim)</p>
                                    </div>
                                </div>
                            </div>
                        `
                    }
                ],
                quiz: [
                    {
                        question: "Apa arti kata 'fitrah' dalam zakat fitrah?",
                        options: ["Kewajiban", "Sifat dasar/kesucian", "Pemberian", "Ibadah"],
                        correct: 1,
                        explanation: "Fitrah berasal dari bahasa Arab yang berarti sifat dasar atau kesucian."
                    },
                    {
                        question: "Kapan zakat fitrah wajib dikeluarkan?",
                        options: ["Setiap bulan", "Bulan Ramadan", "Setelah Idul Fitri", "Kapan saja"],
                        correct: 1,
                        explanation: "Zakat fitrah wajib dikeluarkan pada bulan Ramadan, sebelum shalat Idul Fitri."
                    },
                    {
                        question: "Siapa yang wajib mengeluarkan zakat fitrah?",
                        options: ["Hanya orang kaya", "Semua Muslim yang mampu", "Hanya kepala keluarga", "Hanya orang dewasa"],
                        correct: 1,
                        explanation: "Setiap Muslim yang mampu wajib mengeluarkan zakat fitrah, termasuk untuk anggota keluarganya."
                    },
                    {
                        question: "Apa tujuan utama zakat fitrah?",
                        options: ["Menambah harta", "Mensucikan jiwa dan membantu fakir miskin", "Mengurangi pajak", "Tradisi keluarga"],
                        correct: 1,
                        explanation: "Zakat fitrah bertujuan untuk mensucikan jiwa dari sifat kikir dan membantu fakir miskin."
                    },
                    {
                        question: "Dalam Al-Quran, ayat mana yang menyebutkan tentang kesuksesan orang yang berzakat?",
                        options: ["Al-Baqarah: 43", "Al-A'la: 14", "At-Taubah: 103", "Al-Mu'minun: 4"],
                        correct: 1,
                        explanation: "QS. Al-A'la ayat 14: 'Sungguh beruntung orang yang membersihkan diri (dengan zakat)'"
                    }
                ]
            },
            ketentuan: {
                title: 'Ketentuan dan Syarat Zakat Fitrah',
                materials: [
                    {
                        id: 'syarat_wajib',
                        title: 'Syarat Wajib Zakat Fitrah',
                        unlocked: true,
                        content: `
                            <div class="space-y-6">
                                <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-2xl">
                                    <h4 class="text-xl font-bold text-purple-800 mb-4">
                                        <i class="fas fa-users mr-2"></i>Siapa yang Wajib Zakat Fitrah?
                                    </h4>
                                    <div class="bg-white p-4 rounded-xl border-l-4 border-green-500">
                                        <h5 class="font-bold text-green-800 mb-2">Syarat Wajib:</h5>
                                        <ul class="space-y-2 text-sm">
                                            <li><i class="fas fa-check text-green-500 mr-2"></i>Beragama Islam</li>
                                            <li><i class="fas fa-check text-green-500 mr-2"></i>Hidup pada akhir Ramadan</li>
                                            <li><i class="fas fa-check text-green-500 mr-2"></i>Memiliki kelebihan makanan</li>
                                            <li><i class="fas fa-check text-green-500 mr-2"></i>Merdeka (bukan budak)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    {
                        id: 'takaran_waktu',
                        title: 'Takaran dan Waktu Pembayaran',
                        unlocked: false,
                        requiredScore: 70,
                        requiredMaterial: 'syarat_wajib',
                        content: `
                            <div class="space-y-6">
                                <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-2xl">
                                    <h4 class="text-xl font-bold text-orange-800 mb-4">
                                        <i class="fas fa-balance-scale mr-2"></i>Takaran dan Waktu
                                    </h4>
                                    <div class="grid md:grid-cols-2 gap-4">
                                        <div class="bg-white p-4 rounded-xl border-l-4 border-orange-500">
                                            <h5 class="font-bold text-orange-800 mb-2">Takaran:</h5>
                                            <p class="text-lg font-bold text-orange-700">1 Sha' = 2,5 kg beras</p>
                                            <p class="text-sm text-gray-600">Per orang dalam keluarga</p>
                                        </div>
                                        <div class="bg-white p-4 rounded-xl border-l-4 border-blue-500">
                                            <h5 class="font-bold text-blue-800 mb-2">Waktu:</h5>
                                            <p class="text-sm text-blue-700">• Mulai terbenam matahari akhir Ramadan</p>
                                            <p class="text-sm text-blue-700">• Sebelum shalat Idul Fitri</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `
                    }
                ],
                quiz: [
                    {
                        question: "Berapa takaran zakat fitrah per orang?",
                        options: ["1 kg", "2 kg", "2,5 kg", "3 kg"],
                        correct: 2,
                        explanation: "Takaran zakat fitrah adalah 1 sha' atau sekitar 2,5 kg makanan pokok per orang."
                    },
                    {
                        question: "Apa syarat utama seseorang wajib zakat fitrah?",
                        options: ["Kaya raya", "Muslim dan mampu", "Dewasa saja", "Punya rumah"],
                        correct: 1,
                        explanation: "Syarat utama adalah beragama Islam dan mampu (memiliki kelebihan makanan untuk sehari)."
                    },
                    {
                        question: "Kapan batas akhir pembayaran zakat fitrah?",
                        options: ["Sebelum shalat Idul Fitri", "Setelah shalat Id", "Akhir Ramadan", "Kapan saja"],
                        correct: 0,
                        explanation: "Zakat fitrah harus dibayar sebelum shalat Idul Fitri dimulai."
                    },
                    {
                        question: "Siapa yang berhak menerima zakat fitrah?",
                        options: ["Semua orang", "8 golongan mustahiq", "Hanya fakir miskin", "Keluarga sendiri"],
                        correct: 2,
                        explanation: "Zakat fitrah khusus untuk fakir miskin, berbeda dengan zakat mal yang untuk 8 golongan."
                    },
                    {
                        question: "Jika seseorang meninggal sebelum maghrib akhir Ramadan, apakah wajib zakat fitrah?",
                        options: ["Tetap wajib", "Tidak wajib", "Terserah keluarga", "Setengah saja"],
                        correct: 1,
                        explanation: "Tidak wajib karena syarat wajib adalah hidup pada akhir Ramadan (maghrib terakhir)."
                    }
                ]
            },
            praktik: {
                title: 'Praktik dan Implementasi Zakat Fitrah',
                materials: [
                    {
                        id: 'cara_hitung',
                        title: 'Cara Menghitung Zakat Fitrah',
                        unlocked: true,
                        content: `
                            <div class="space-y-6">
                                <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 p-6 rounded-2xl">
                                    <h4 class="text-xl font-bold text-indigo-800 mb-4">
                                        <i class="fas fa-calculator mr-2"></i>Cara Menghitung Zakat Fitrah
                                    </h4>
                                    <div class="bg-white p-4 rounded-xl">
                                        <h5 class="font-bold mb-2">Contoh Perhitungan Keluarga 4 Orang:</h5>
                                        <p class="text-lg">4 orang × 2,5 kg = <span class="font-bold text-indigo-600">10 kg beras</span></p>
                                        <p class="text-sm text-gray-600">Atau setara uang: 4 × Rp 37.500 = Rp 150.000</p>
                                    </div>
                                    <div class="bg-white p-4 rounded-xl mt-4">
                                        <h5 class="font-bold mb-2">Rumus Sederhana:</h5>
                                        <p class="text-sm">Jumlah Anggota Keluarga × 2,5 kg × Harga Beras per kg</p>
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    {
                        id: 'cara_salur',
                        title: 'Cara Menyalurkan Zakat Fitrah',
                        unlocked: false,
                        requiredScore: 70,
                        requiredMaterial: 'cara_hitung',
                        content: `
                            <div class="space-y-6">
                                <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-2xl">
                                    <h4 class="text-xl font-bold text-green-800 mb-4">
                                        <i class="fas fa-hand-holding-heart mr-2"></i>Cara Menyalurkan
                                    </h4>
                                    <div class="grid md:grid-cols-2 gap-4">
                                        <div class="bg-white p-4 rounded-xl">
                                            <h5 class="font-bold text-green-700 mb-2">
                                                <i class="fas fa-mosque mr-2"></i>Melalui Masjid
                                            </h5>
                                            <ul class="text-sm space-y-1">
                                                <li>• Mudah dan praktis</li>
                                                <li>• Ada bukti penyerahan</li>
                                                <li>• Distribusi merata</li>
                                                <li>• Terpercaya</li>
                                            </ul>
                                        </div>
                                        <div class="bg-white p-4 rounded-xl">
                                            <h5 class="font-bold text-green-700 mb-2">
                                                <i class="fas fa-handshake mr-2"></i>Langsung ke Mustahiq
                                            </h5>
                                            <ul class="text-sm space-y-1">
                                                <li>• Lebih personal</li>
                                                <li>• Tahu penerima pasti</li>
                                                <li>• Pilih yang membutuhkan</li>
                                                <li>• Pahala lebih besar</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `
                    }
                ],
                quiz: [
                    {
                        question: "Keluarga 5 orang harus mengeluarkan zakat fitrah sebanyak:",
                        options: ["10 kg", "12,5 kg", "15 kg", "20 kg"],
                        correct: 1,
                        explanation: "5 orang × 2,5 kg = 12,5 kg beras untuk zakat fitrah."
                    },
                    {
                        question: "Jika harga beras Rp 15.000/kg, berapa zakat fitrah untuk 1 orang dalam bentuk uang?",
                        options: ["Rp 30.000", "Rp 37.500", "Rp 40.000", "Rp 45.000"],
                        correct: 1,
                        explanation: "2,5 kg × Rp 15.000 = Rp 37.500 untuk zakat fitrah 1 orang."
                    },
                    {
                        question: "Manakah cara terbaik menyalurkan zakat fitrah?",
                        options: ["Melalui media sosial", "Langsung ke mustahiq atau melalui amil", "Ditabung dulu", "Diberikan ke tetangga kaya"],
                        correct: 1,
                        explanation: "Cara terbaik adalah langsung ke mustahiq (fakir miskin) atau melalui amil zakat terpercaya."
                    },
                    {
                        question: "Kapan waktu terbaik mengeluarkan zakat fitrah?",
                        options: ["Awal Ramadan", "Pertengahan Ramadan", "Beberapa hari sebelum Idul Fitri", "Setelah Idul Fitri"],
                        correct: 2,
                        explanation: "Waktu terbaik adalah beberapa hari sebelum Idul Fitri agar fakir miskin bisa merayakan Idul Fitri."
                    },
                    {
                        question: "Jika keluarga 6 orang dengan harga beras Rp 12.000/kg, total zakat fitrah dalam uang adalah:",
                        options: ["Rp 150.000", "Rp 180.000", "Rp 200.000", "Rp 220.000"],
                        correct: 1,
                        explanation: "6 orang × 2,5 kg × Rp 12.000 = Rp 180.000"
                    }
                ]
            }
        };

        // Navigation Functions
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Find and activate the corresponding nav item
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                if (item.onclick && item.onclick.toString().includes(pageId)) {
                    item.classList.add('active');
                }
            });
        }

        function closeLearningModal() {
            document.getElementById('learningModal').classList.add('hidden');
        }

        function calculateZakat() {
            const familyMembers = parseInt(document.getElementById('familyMembers').value) || 0;
            const ricePrice = parseInt(document.getElementById('ricePrice').value) || 0;
            const paymentType = document.getElementById('paymentType').value;
            
            if (familyMembers <= 0 || ricePrice <= 0) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Data Tidak Valid',
                    text: 'Mohon masukkan jumlah anggota keluarga dan harga beras yang valid!',
                    confirmButtonColor: '#f59e0b'
                });
                return;
            }
            
            const riceAmount = familyMembers * 2.5; // kg
            const moneyAmount = riceAmount * ricePrice;
            
            let resultHtml = `
                <div class="space-y-4">
                    <div class="text-center">
                        <div class="text-4xl mb-2">🕌</div>
                        <h4 class="text-xl font-bold text-blue-800 mb-4">Hasil Perhitungan Zakat Fitrah</h4>
                    </div>
                    
                    <div class="bg-white p-4 rounded-xl border-l-4 border-blue-500">
                        <h5 class="font-bold text-blue-800 mb-2">Data Keluarga:</h5>
                        <p class="text-sm">Jumlah anggota: ${familyMembers} orang</p>
                        <p class="text-sm">Harga beras: Rp ${ricePrice.toLocaleString()}/kg</p>
                    </div>
                    
                    <div class="bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-xl">
                        <h5 class="font-bold text-green-800 mb-3">Jumlah Zakat Fitrah:</h5>
                        <div class="space-y-2">
                            <div class="flex justify-between items-center">
                                <span class="text-sm">Dalam bentuk beras:</span>
                                <span class="font-bold text-green-700">${riceAmount} kg</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm">Dalam bentuk uang:</span>
                                <span class="font-bold text-green-700">Rp ${moneyAmount.toLocaleString()}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-yellow-50 p-4 rounded-xl border-l-4 border-yellow-500">
                        <h5 class="font-bold text-yellow-800 mb-2">Catatan Penting:</h5>
                        <ul class="text-sm text-yellow-700 space-y-1">
                            <li>• Zakat fitrah wajib dibayar sebelum shalat Idul Fitri</li>
                            <li>• Dapat dibayar dalam bentuk beras atau uang setara</li>
                            <li>• Diberikan kepada fakir miskin di sekitar tempat tinggal</li>
                        </ul>
                    </div>
                </div>
            `;
            
            document.getElementById('calculatorResult').innerHTML = resultHtml;
            
            // Save to history
            calculatorHistory.push({
                familyMembers: familyMembers,
                ricePrice: ricePrice,
                paymentType: paymentType,
                riceAmount: riceAmount,
                moneyAmount: moneyAmount,
                timestamp: new Date()
            });
        }

        function showPaymentSimulation() {
            const paymentContent = `
                <div class="space-y-6">
                    <div class="text-center">
                        <div class="text-4xl mb-2">💳</div>
                        <p class="text-gray-600">Simulasi pembayaran zakat fitrah untuk pembelajaran</p>
                    </div>
                    
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-2xl">
                        <h4 class="text-lg font-bold text-blue-800 mb-4">Pilih Metode Pembayaran:</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="payment-method bg-white p-4 rounded-xl border-2 border-gray-200 cursor-pointer" onclick="selectPaymentMethod('cash')">
                                <div class="text-center">
                                    <i class="fas fa-money-bill-wave text-3xl text-green-500 mb-2"></i>
                                    <h5 class="font-bold">Tunai</h5>
                                    <p class="text-sm text-gray-600">Bayar langsung dengan uang tunai</p>
                                </div>
                            </div>
                            <div class="payment-method bg-white p-4 rounded-xl border-2 border-gray-200 cursor-pointer" onclick="selectPaymentMethod('rice')">
                                <div class="text-center">
                                    <i class="fas fa-seedling text-3xl text-yellow-600 mb-2"></i>
                                    <h5 class="font-bold">Beras</h5>
                                    <p class="text-sm text-gray-600">Bayar dengan beras langsung</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="paymentForm" class="hidden">
                        <!-- Payment form will be inserted here -->
                    </div>
                </div>
            `;
            
            document.getElementById('paymentContent').innerHTML = paymentContent;
            document.getElementById('paymentModal').classList.remove('hidden');
        }

        function selectPaymentMethod(method) {
            // Remove selected class from all methods
            document.querySelectorAll('.payment-method').forEach(el => {
                el.classList.remove('selected');
            });
            
            // Add selected class to clicked method
            event.currentTarget.classList.add('selected');
            
            let formHtml = '';
            
            if (method === 'cash') {
                formHtml = `
                    <div class="bg-white p-6 rounded-2xl border">
                        <h5 class="font-bold text-gray-800 mb-4">Pembayaran Tunai</h5>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Jumlah yang harus dibayar:</label>
                                <input type="text" class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl bg-gray-50" value="Rp 150.000" readonly>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Nama Pembayar:</label>
                                <input type="text" id="payerName" class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-green-500 focus:outline-none" placeholder="Masukkan nama">
                            </div>
                            <button onclick="processPayment('cash')" class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-3 rounded-xl font-bold hover:from-green-600 hover:to-green-700 transition-all">
                                <i class="fas fa-credit-card mr-2"></i>Bayar Sekarang
                            </button>
                        </div>
                    </div>
                `;
            } else if (method === 'rice') {
                formHtml = `
                    <div class="bg-white p-6 rounded-2xl border">
                        <h5 class="font-bold text-gray-800 mb-4">Pembayaran Beras</h5>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Jumlah beras yang harus diserahkan:</label>
                                <input type="text" class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl bg-gray-50" value="10 kg beras" readonly>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Nama Pembayar:</label>
                                <input type="text" id="payerNameRice" class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-green-500 focus:outline-none" placeholder="Masukkan nama">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Jenis Beras:</label>
                                <select class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-green-500 focus:outline-none">
                                    <option>Beras Putih Biasa</option>
                                    <option>Beras Merah</option>
                                    <option>Beras Premium</option>
                                </select>
                            </div>
                            <button onclick="processPayment('rice')" class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-3 rounded-xl font-bold hover:from-green-600 hover:to-green-700 transition-all">
                                <i class="fas fa-hand-holding mr-2"></i>Serahkan Beras
                            </button>
                        </div>
                    </div>
                `;
            }
            
            document.getElementById('paymentForm').innerHTML = formHtml;
            document.getElementById('paymentForm').classList.remove('hidden');
        }

        function processPayment(method) {
            const payerName = method === 'cash' ? 
                document.getElementById('payerName').value : 
                document.getElementById('payerNameRice').value;
            
            if (!payerName.trim()) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Nama Belum Diisi',
                    text: 'Mohon masukkan nama pembayar terlebih dahulu!',
                    confirmButtonColor: '#f59e0b'
                });
                return;
            }
            
            // Simulate payment processing
            Swal.fire({
                title: 'Memproses Pembayaran...',
                text: 'Mohon tunggu sebentar',
                allowOutsideClick: false,
                showConfirmButton: false,
                willOpen: () => {
                    Swal.showLoading();
                }
            });
            
            setTimeout(() => {
                Swal.fire({
                    icon: 'success',
                    title: 'Pembayaran Berhasil!',
                    html: `
                        <div class="text-center">
                            <div class="text-4xl mb-4">🎉</div>
                            <p class="mb-2">Terima kasih <strong>${payerName}</strong></p>
                            <p class="text-sm text-gray-600">
                                Zakat fitrah Anda telah berhasil ${method === 'cash' ? 'dibayar' : 'diserahkan'}
                            </p>
                            <div class="bg-green-50 p-4 rounded-xl mt-4">
                                <p class="text-sm text-green-700">
                                    <i class="fas fa-info-circle mr-1"></i>
                                    Ini adalah simulasi untuk pembelajaran. Dalam praktik nyata, 
                                    pastikan menyerahkan zakat ke lembaga atau orang yang tepat.
                                </p>
                            </div>
                        </div>
                    `,
                    confirmButtonColor: '#10b981',
                    confirmButtonText: 'Selesai'
                }).then(() => {
                    closePaymentModal();
                });
            }, 2000);
        }

        function closePaymentModal() {
            document.getElementById('paymentModal').classList.add('hidden');
        }

        // Initialize the app when page loads
        window.addEventListener('load', function() {
            // Auto-update study time every minute
            setInterval(() => {
                if (studyStartTime) {
                    updateProgressDisplays();
                }
            }, 60000);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'974070c42454ab62',t:'MTc1NjAxMzI0Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
